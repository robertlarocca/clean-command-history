#!/bin/bash

# Copyright (c) 2022 Robert LaRocca http://www.laroccx.com

# require root privileges
require_root_privileges() {
	if [ $(id -u) != 0 ]; then
		logger -i "Error: $(basename $0 .sh) must be run as root!"
		echo "Error: $(basename $0 .sh) must be run as root!"
		exit 1
	fi
}

require_root_privileges

main() {
	# Install clean command
	cp -b -S .bak -v $PWD/clean /usr/local/bin/

	chown root:root /usr/local/bin/clean
	chmod 0755 /usr/local/bin/clean

	# Enable clean command
	cat <<-EOF_XYZ >/etc/profile.d/clean.sh
		# Copyright (c) 2022 Robert LaRocca http://www.laroccx.com

		# Enable clean command for interactive shells
		if [ -f /usr/local/bin/clean ]; then
			. /usr/local/bin/clean
		fi
	EOF_XYZ

	chown root:root /etc/profile.d/clean.sh
	chmod 0644 /etc/profile.d/clean.sh
}

main "$@"

# vi: syntax=sh ts=4 noexpandtab
